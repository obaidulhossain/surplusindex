{% extends 'base.html' %}
{% block title %}
Active Subscriptions
{% endblock title %}


{% block content %}
{% load static %}
{% load custom_filters %}
<link href="{% static 'css/surplusindex.css' %}" rel="stylesheet">
<div class="section-header">
    <h4>Active Subscriptions</h4>
</div>
<div class="section-body-full">
    <form method="post">
    {% csrf_token %}
        <label for="plans">Select a Plan</label></br>
        <select name="selectedPlan" onchange="this.form.submit()">
        <option value="">Select a Plan</option>
        {% for plan in AvailablePlans %}
        <option value="{{plan.id}}">{{plan.name|upper}}</option>
        {% endfor %}
        </select>
    </form>
    <div class="section-body-full">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>Started In</th>
                    <th>Ending In</th>
                    <th style="width:300px;">Subscription Name</th>
                    <th>Username</th>
                    <th>SID</th>
                    <th>Status</th>
                    
                </tr>
            </thead>
            <tbody>
            {% for sub in Subscriptions %}
                <tr>
                    <td>{{sub.created_at|date:"m/d/Y"}}</td>
                    <td>{{sub.current_period_end|date:"m/d/Y"}}</td>
                    <td>{{sub.plan.name}}</td>
                    <td>{{sub.user.username}}</td>
                    <td>{{sub.subscription_id}}</td>
                    <td>{% if sub.status == "active" %}<i class="bi bi-check-circle-fill" title="{{sub.status}}" style="color:green;"></i>{% elif sub.status == "canceled" %}<i class="bi bi-x-circle-fill" style="color:red;" title="{{sub.status}}"></i>{% else %}<i class="bi bi-exclamation-diamond-fill" style="color:yellow;" title="{{sub.status}}"></i>{% endif %}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock content %}